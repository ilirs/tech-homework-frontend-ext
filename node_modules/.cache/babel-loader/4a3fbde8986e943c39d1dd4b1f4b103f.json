{"ast":null,"code":"import { transformToViewState, applyViewStateToTransform, cloneTransform } from '../utils/transform';\nimport { normalizeStyle } from '../utils/style-utils';\nimport { deepEqual } from '../utils/deep-equal';\nconst pointerEvents = {\n  mousedown: 'onMouseDown',\n  mouseup: 'onMouseUp',\n  mouseover: 'onMouseOver',\n  mousemove: 'onMouseMove',\n  click: 'onClick',\n  dblclick: 'onDblClick',\n  mouseenter: 'onMouseEnter',\n  mouseleave: 'onMouseLeave',\n  mouseout: 'onMouseOut',\n  contextmenu: 'onContextMenu',\n  touchstart: 'onTouchStart',\n  touchend: 'onTouchEnd',\n  touchmove: 'onTouchMove',\n  touchcancel: 'onTouchCancel'\n};\nconst cameraEvents = {\n  movestart: 'onMoveStart',\n  move: 'onMove',\n  moveend: 'onMoveEnd',\n  dragstart: 'onDragStart',\n  drag: 'onDrag',\n  dragend: 'onDragEnd',\n  zoomstart: 'onZoomStart',\n  zoom: 'onZoom',\n  zoomend: 'onZoomEnd',\n  rotatestart: 'onRotateStart',\n  rotate: 'onRotate',\n  rotateend: 'onRotateEnd',\n  pitchstart: 'onPitchStart',\n  pitch: 'onPitch',\n  pitchend: 'onPitchEnd'\n};\nconst otherEvents = {\n  wheel: 'onWheel',\n  boxzoomstart: 'onBoxZoomStart',\n  boxzoomend: 'onBoxZoomEnd',\n  boxzoomcancel: 'onBoxZoomCancel',\n  resize: 'onResize',\n  load: 'onLoad',\n  render: 'onRender',\n  idle: 'onIdle',\n  remove: 'onRemove',\n  data: 'onData',\n  styledata: 'onStyleData',\n  sourcedata: 'onSourceData',\n  error: 'onError'\n};\nconst settingNames = ['minZoom', 'maxZoom', 'minPitch', 'maxPitch', 'maxBounds', 'projection', 'renderWorldCopies'];\nconst handlerNames = ['scrollZoom', 'boxZoom', 'dragRotate', 'dragPan', 'keyboard', 'doubleClickZoom', 'touchZoomRotate', 'touchPitch'];\n/**\n * A wrapper for mapbox-gl's Map class\n */\n\nexport default class Mapbox {\n  constructor(MapClass, props, container) {\n    // mapboxgl.Map instance. Not using type here because we are accessing\n    // private members and methods\n    this._map = null; // Internal states\n\n    this._internalUpdate = false;\n    this._inRender = false;\n    this._hoveredFeatures = null;\n    this._deferredEvents = {\n      move: false,\n      zoom: false,\n      pitch: false,\n      rotate: false\n    };\n\n    this._onEvent = e => {\n      // @ts-ignore\n      const cb = this.props[otherEvents[e.type]];\n\n      if (cb) {\n        cb(e);\n      }\n    };\n\n    this._onPointerEvent = e => {\n      if (e.type === 'mousemove' || e.type === 'mouseout') {\n        this._updateHover(e);\n      } // @ts-ignore\n\n\n      const cb = this.props[pointerEvents[e.type]];\n\n      if (cb) {\n        if (this.props.interactiveLayerIds && e.type !== 'mouseover' && e.type !== 'mouseout') {\n          const features = this._hoveredFeatures || this._map.queryRenderedFeatures(e.point, {\n            layers: this.props.interactiveLayerIds\n          });\n\n          e.features = features;\n        }\n\n        cb(e);\n        delete e.features;\n      }\n    };\n\n    this._onCameraEvent = e => {\n      if (!this._internalUpdate) {\n        // @ts-ignore\n        const cb = this.props[cameraEvents[e.type]];\n\n        if (cb) {\n          cb(e);\n        }\n      }\n\n      if (e.type in this._deferredEvents) {\n        this._deferredEvents[e.type] = false;\n      }\n    };\n\n    this._MapClass = MapClass;\n    this.props = props;\n\n    this._initialize(container);\n  }\n\n  get map() {\n    return this._map;\n  }\n\n  get transform() {\n    return this._renderTransform;\n  }\n\n  setProps(props) {\n    const oldProps = this.props;\n    this.props = props;\n\n    const settingsChanged = this._updateSettings(props, oldProps);\n\n    if (settingsChanged) {\n      this._createShadowTransform(this._map);\n    }\n\n    const sizeChanged = this._updateSize(props);\n\n    const viewStateChanged = this._updateViewState(props, true);\n\n    this._updateStyle(props, oldProps);\n\n    this._updateStyleComponents(props, oldProps);\n\n    this._updateHandlers(props, oldProps); // If 1) view state has changed to match props and\n    //    2) the props change is not triggered by map events,\n    // it's driven by an external state change. Redraw immediately\n\n\n    if (settingsChanged || sizeChanged || viewStateChanged && !this._map.isMoving()) {\n      this.redraw();\n    }\n  }\n\n  static reuse(props, container) {\n    const that = Mapbox.savedMaps.pop();\n\n    if (!that) {\n      return null;\n    }\n\n    const map = that.map; // When reusing the saved map, we need to reparent the map(canvas) and other child nodes\n    // intoto the new container from the props.\n    // Step1: reparenting child nodes from old container to new container\n\n    const oldContainer = map.getContainer();\n    container.className = oldContainer.className;\n\n    while (oldContainer.childNodes.length > 0) {\n      container.appendChild(oldContainer.childNodes[0]);\n    } // Step2: replace the internal container with new container from the react component\n    // @ts-ignore\n\n\n    map._container = container; // Step 3: apply new props\n\n    that.setProps({ ...props,\n      styleDiffing: false\n    });\n    map.resize();\n    const {\n      initialViewState\n    } = props;\n\n    if (initialViewState) {\n      if (initialViewState.bounds) {\n        map.fitBounds(initialViewState.bounds, { ...initialViewState.fitBoundsOptions,\n          duration: 0\n        });\n      } else {\n        that._updateViewState(initialViewState, false);\n      }\n    } // Simulate load event\n\n\n    if (map.isStyleLoaded()) {\n      map.fire('load');\n    } else {\n      map.once('styledata', () => map.fire('load'));\n    }\n\n    return that;\n  }\n  /* eslint-disable complexity,max-statements */\n\n\n  _initialize(container) {\n    const {\n      props\n    } = this;\n    const mapOptions = { ...props,\n      ...props.initialViewState,\n      accessToken: props.mapboxAccessToken || getAccessTokenFromEnv() || null,\n      container,\n      style: normalizeStyle(props.mapStyle)\n    };\n    const viewState = mapOptions.initialViewState || mapOptions.viewState || mapOptions;\n    Object.assign(mapOptions, {\n      center: [viewState.longitude || 0, viewState.latitude || 0],\n      zoom: viewState.zoom || 0,\n      pitch: viewState.pitch || 0,\n      bearing: viewState.bearing || 0\n    });\n\n    if (props.gl) {\n      // eslint-disable-next-line\n      const getContext = HTMLCanvasElement.prototype.getContext; // Hijack canvas.getContext to return our own WebGLContext\n      // This will be called inside the mapboxgl.Map constructor\n      // @ts-expect-error\n\n      HTMLCanvasElement.prototype.getContext = () => {\n        // Unhijack immediately\n        HTMLCanvasElement.prototype.getContext = getContext;\n        return props.gl;\n      };\n    }\n\n    const map = new this._MapClass(mapOptions); // Props that are not part of constructor options\n\n    if (viewState.padding) {\n      map.setPadding(viewState.padding);\n    }\n\n    if (props.cursor) {\n      map.getCanvas().style.cursor = props.cursor;\n    }\n\n    this._createShadowTransform(map); // Hack\n    // Insert code into map's render cycle\n\n\n    const renderMap = map._render;\n\n    map._render = arg => {\n      this._inRender = true;\n      renderMap.call(map, arg);\n      this._inRender = false;\n    };\n\n    const runRenderTaskQueue = map._renderTaskQueue.run;\n\n    map._renderTaskQueue.run = arg => {\n      runRenderTaskQueue.call(map._renderTaskQueue, arg);\n\n      this._onBeforeRepaint();\n    };\n\n    map.on('render', () => this._onAfterRepaint()); // Insert code into map's event pipeline\n\n    const fireEvent = map.fire;\n    map.fire = this._fireEvent.bind(this, fireEvent); // add listeners\n\n    map.on('resize', () => {\n      this._renderTransform.resize(map.transform.width, map.transform.height);\n    });\n    map.on('styledata', () => this._updateStyleComponents(this.props, {}));\n    map.on('sourcedata', () => this._updateStyleComponents(this.props, {}));\n\n    for (const eventName in pointerEvents) {\n      map.on(eventName, this._onPointerEvent);\n    }\n\n    for (const eventName in cameraEvents) {\n      map.on(eventName, this._onCameraEvent);\n    }\n\n    for (const eventName in otherEvents) {\n      map.on(eventName, this._onEvent);\n    }\n\n    this._map = map;\n  }\n  /* eslint-enable complexity,max-statements */\n\n\n  recycle() {\n    Mapbox.savedMaps.push(this);\n  }\n\n  destroy() {\n    this._map.remove();\n  } // Force redraw the map now. Typically resize() and jumpTo() is reflected in the next\n  // render cycle, which is managed by Mapbox's animation loop.\n  // This removes the synchronization issue caused by requestAnimationFrame.\n\n\n  redraw() {\n    const map = this._map; // map._render will throw error if style does not exist\n    // https://github.com/mapbox/mapbox-gl-js/blob/fb9fc316da14e99ff4368f3e4faa3888fb43c513\n    //   /src/ui/map.js#L1834\n\n    if (!this._inRender && map.style) {\n      // cancel the scheduled update\n      if (map._frame) {\n        map._frame.cancel();\n\n        map._frame = null;\n      } // the order is important - render() may schedule another update\n\n\n      map._render();\n    }\n  }\n\n  _createShadowTransform(map) {\n    const renderTransform = cloneTransform(map.transform);\n    map.painter.transform = renderTransform;\n    this._renderTransform = renderTransform;\n  }\n  /* Trigger map resize if size is controlled\n     @param {object} nextProps\n     @returns {bool} true if size has changed\n   */\n\n\n  _updateSize(nextProps) {\n    // Check if size is controlled\n    const {\n      viewState\n    } = nextProps;\n\n    if (viewState) {\n      const map = this._map;\n\n      if (viewState.width !== map.transform.width || viewState.height !== map.transform.height) {\n        map.resize();\n        return true;\n      }\n    }\n\n    return false;\n  } // Adapted from map.jumpTo\n\n  /* Update camera to match props\n     @param {object} nextProps\n     @param {bool} triggerEvents - should fire camera events\n     @returns {bool} true if anything is changed\n   */\n\n\n  _updateViewState(nextProps, triggerEvents) {\n    if (this._internalUpdate) {\n      return false;\n    }\n\n    const map = this._map;\n    const tr = this._renderTransform; // Take a snapshot of the transform before mutation\n\n    const {\n      zoom,\n      pitch,\n      bearing\n    } = tr;\n    const isMoving = map.isMoving();\n\n    if (isMoving) {\n      // All movement of the camera is done relative to the sea level\n      tr.cameraElevationReference = 'sea';\n    }\n\n    const changed = applyViewStateToTransform(tr, { ...transformToViewState(map.transform),\n      ...nextProps\n    });\n\n    if (isMoving) {\n      // Reset camera reference\n      tr.cameraElevationReference = 'ground';\n    }\n\n    if (changed && triggerEvents) {\n      const deferredEvents = this._deferredEvents; // Delay DOM control updates to the next render cycle\n\n      deferredEvents.move = true;\n      deferredEvents.zoom || (deferredEvents.zoom = zoom !== tr.zoom);\n      deferredEvents.rotate || (deferredEvents.rotate = bearing !== tr.bearing);\n      deferredEvents.pitch || (deferredEvents.pitch = pitch !== tr.pitch);\n    } // Avoid manipulating the real transform when interaction/animation is ongoing\n    // as it would interfere with Mapbox's handlers\n\n\n    if (!isMoving) {\n      applyViewStateToTransform(map.transform, nextProps);\n    }\n\n    return changed;\n  }\n  /* Update camera constraints and projection settings to match props\n     @param {object} nextProps\n     @param {object} currProps\n     @returns {bool} true if anything is changed\n   */\n\n\n  _updateSettings(nextProps, currProps) {\n    const map = this._map;\n    let changed = false;\n\n    for (const propName of settingNames) {\n      if (propName in nextProps && !deepEqual(nextProps[propName], currProps[propName])) {\n        changed = true;\n        map[`set${propName[0].toUpperCase()}${propName.slice(1)}`](nextProps[propName]);\n      }\n    }\n\n    return changed;\n  }\n  /* Update map style to match props\n     @param {object} nextProps\n     @param {object} currProps\n     @returns {bool} true if style is changed\n   */\n\n\n  _updateStyle(nextProps, currProps) {\n    if (nextProps.cursor !== currProps.cursor) {\n      this._map.getCanvas().style.cursor = nextProps.cursor;\n    }\n\n    if (nextProps.mapStyle !== currProps.mapStyle) {\n      const options = {\n        diff: nextProps.styleDiffing\n      };\n\n      if ('localIdeographFontFamily' in nextProps) {\n        options.localIdeographFontFamily = nextProps.localIdeographFontFamily;\n      }\n\n      this._map.setStyle(normalizeStyle(nextProps.mapStyle), options);\n\n      return true;\n    }\n\n    return false;\n  }\n  /* Update fog, light and terrain to match props\n     @param {object} nextProps\n     @param {object} currProps\n     @returns {bool} true if anything is changed\n   */\n\n\n  _updateStyleComponents(nextProps, currProps) {\n    const map = this._map;\n    let changed = false;\n\n    if (map.style.loaded()) {\n      if ('light' in nextProps && !deepEqual(nextProps.light, currProps.light)) {\n        changed = true;\n        map.setLight(nextProps.light);\n      }\n\n      if ('fog' in nextProps && !deepEqual(nextProps.fog, currProps.fog)) {\n        changed = true;\n        map.setFog(nextProps.fog);\n      }\n\n      if ('terrain' in nextProps && !deepEqual(nextProps.terrain, currProps.terrain)) {\n        if (!nextProps.terrain || map.getSource(nextProps.terrain.source)) {\n          changed = true;\n          map.setTerrain(nextProps.terrain);\n        }\n      }\n    }\n\n    return changed;\n  }\n  /* Update interaction handlers to match props\n     @param {object} nextProps\n     @param {object} currProps\n     @returns {bool} true if anything is changed\n   */\n\n\n  _updateHandlers(nextProps, currProps) {\n    const map = this._map;\n    let changed = false;\n\n    for (const propName of handlerNames) {\n      const newValue = nextProps[propName];\n\n      if (!deepEqual(newValue, currProps[propName])) {\n        changed = true;\n\n        if (newValue) {\n          map[propName].enable(newValue);\n        } else {\n          map[propName].disable();\n        }\n      }\n    }\n\n    return changed;\n  }\n\n  _updateHover(e) {\n    var _a;\n\n    const {\n      props\n    } = this;\n    const shouldTrackHoveredFeatures = props.interactiveLayerIds && (props.onMouseMove || props.onMouseEnter || props.onMouseLeave);\n\n    if (shouldTrackHoveredFeatures) {\n      const eventType = e.type;\n      const wasHovering = ((_a = this._hoveredFeatures) === null || _a === void 0 ? void 0 : _a.length) > 0;\n      let features;\n\n      if (eventType === 'mousemove') {\n        try {\n          features = this._map.queryRenderedFeatures(e.point, {\n            layers: props.interactiveLayerIds\n          });\n        } catch (_b) {\n          features = [];\n        }\n      } else {\n        features = [];\n      }\n\n      const isHovering = features.length > 0;\n\n      if (!isHovering && wasHovering) {\n        e.type = 'mouseleave';\n\n        this._onPointerEvent(e);\n      }\n\n      this._hoveredFeatures = features;\n\n      if (isHovering && !wasHovering) {\n        e.type = 'mouseenter';\n\n        this._onPointerEvent(e);\n      }\n\n      e.type = eventType;\n    } else {\n      this._hoveredFeatures = null;\n    }\n  }\n\n  _fireEvent(baseFire, event, properties) {\n    const map = this._map;\n    const tr = map.transform;\n    const eventType = typeof event === 'string' ? event : event.type;\n\n    if (eventType === 'move') {\n      this._updateViewState(this.props, false);\n    }\n\n    if (eventType in cameraEvents) {\n      if (typeof event === 'object') {\n        event.viewState = transformToViewState(tr);\n      }\n\n      if (this._map.isMoving()) {\n        // Replace map.transform with ours during the callbacks\n        map.transform = this._renderTransform;\n        baseFire.call(map, event, properties);\n        map.transform = tr;\n        return map;\n      }\n    }\n\n    baseFire.call(map, event, properties);\n    return map;\n  } // All camera manipulations are complete, ready to repaint\n\n\n  _onBeforeRepaint() {\n    const map = this._map; // If there are camera changes driven by props, invoke camera events so that DOM controls are synced\n\n    this._internalUpdate = true;\n\n    for (const eventType in this._deferredEvents) {\n      if (this._deferredEvents[eventType]) {\n        map.fire(eventType);\n      }\n    }\n\n    this._internalUpdate = false;\n    const tr = this._map.transform; // Make sure camera matches the current props\n\n    this._map.transform = this._renderTransform;\n\n    this._onAfterRepaint = () => {\n      // Restores camera state before render/load events are fired\n      this._map.transform = tr;\n    };\n  }\n\n}\nMapbox.savedMaps = [];\n/**\n * Access token can be provided via one of:\n *   mapboxAccessToken prop\n *   access_token query parameter\n *   MapboxAccessToken environment variable\n *   REACT_APP_MAPBOX_ACCESS_TOKEN environment variable\n * @returns access token\n */\n\nfunction getAccessTokenFromEnv() {\n  let accessToken = null;\n  /* global location, process */\n\n  if (typeof location !== 'undefined') {\n    const match = /access_token=([^&\\/]*)/.exec(location.search);\n    accessToken = match && match[1];\n  } // Note: This depends on bundler plugins (e.g. webpack) importing environment correctly\n\n\n  try {\n    accessToken = accessToken || process.env.MapboxAccessToken;\n  } catch (_a) {// ignore\n  }\n\n  try {\n    accessToken = accessToken || process.env.REACT_APP_MAPBOX_ACCESS_TOKEN;\n  } catch (_b) {// ignore\n  }\n\n  return accessToken;\n}","map":{"version":3,"mappings":"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","names":["transformToViewState","applyViewStateToTransform","cloneTransform","normalizeStyle","deepEqual","pointerEvents","mousedown","mouseup","mouseover","mousemove","click","dblclick","mouseenter","mouseleave","mouseout","contextmenu","touchstart","touchend","touchmove","touchcancel","cameraEvents","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoom","zoomend","rotatestart","rotate","rotateend","pitchstart","pitch","pitchend","otherEvents","wheel","boxzoomstart","boxzoomend","boxzoomcancel","resize","load","render","idle","remove","data","styledata","sourcedata","error","settingNames","handlerNames","Mapbox","constructor","MapClass","props","container","e","cb","type","_updateHover","interactiveLayerIds","features","_hoveredFeatures","_map","queryRenderedFeatures","point","layers","_internalUpdate","_deferredEvents","_MapClass","_initialize","map","transform","_renderTransform","setProps","oldProps","settingsChanged","_updateSettings","_createShadowTransform","sizeChanged","_updateSize","viewStateChanged","_updateViewState","_updateStyle","_updateStyleComponents","_updateHandlers","isMoving","redraw","reuse","that","savedMaps","pop","oldContainer","getContainer","className","childNodes","length","appendChild","_container","styleDiffing","initialViewState","bounds","fitBounds","fitBoundsOptions","duration","isStyleLoaded","fire","once","mapOptions","accessToken","mapboxAccessToken","getAccessTokenFromEnv","style","mapStyle","viewState","Object","assign","center","longitude","latitude","bearing","gl","getContext","HTMLCanvasElement","prototype","padding","setPadding","cursor","getCanvas","renderMap","_render","arg","_inRender","call","runRenderTaskQueue","_renderTaskQueue","run","_onBeforeRepaint","on","_onAfterRepaint","fireEvent","_fireEvent","bind","width","height","eventName","_onPointerEvent","_onCameraEvent","_onEvent","recycle","push","destroy","_frame","cancel","renderTransform","painter","nextProps","triggerEvents","tr","cameraElevationReference","changed","deferredEvents","currProps","propName","toUpperCase","slice","options","diff","localIdeographFontFamily","setStyle","loaded","light","setLight","fog","setFog","terrain","getSource","source","setTerrain","newValue","enable","disable","shouldTrackHoveredFeatures","onMouseMove","onMouseEnter","onMouseLeave","eventType","wasHovering","_a","isHovering","baseFire","event","properties","location","match","exec","search","process","env","MapboxAccessToken","REACT_APP_MAPBOX_ACCESS_TOKEN"],"sourceRoot":"","sources":["../../../src/mapbox/mapbox.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}